# 테스트 구축하기

리팩토링은 분명 가치 있는 도구지만, 이것 만으로는 부족하다. 불가피하게 저지르는 실수를 잡아주는 견고한 테스트 스위트가 뒷받침 돼야 한다. 리팩토링을 하지 않더라도 좋은 테스트를 작성하는 것은 개발 효율을 높일 수 있다.

테스트를 작성은 프로그래밍을 시작하기 전이 가장 좋다. 그 이유는 원하는 기능을 추가하기 위해 무엇이 필요한지 고민하게 되고, 구현보다 인터페이스에 집중하게 된다는 장점도 있다. 또한 코딩이 완료되는 시점을 좀 더 정확하게 판단할 수 있다. 테스트를 모두 통과한 시점이 완료되는 시점이기 때문이다.

## 테스트 샘플 코드

`사용자가 생산 계획을 검토하고 수정하도록 하는 간단한 애플리케이션`

1. `생산 계획`은 각 `지역`의 `수요`와 `가격`으로 구성된다.
2. `지역`에 위치한 `생산자`들은 각기 제품을 특정 `가격`으로 특정 `수량`만큼 생산할 수 있다.
3. 생산자별로 제품을 모두 판매했을 때 얻을 수 있는 `수익`도 보여준다.
4. 생산 `부족분`과 현재 계획에서 거둘 수 있는 `총수익`도 보여준다.
5. 사용자는 수요, 가격, 생산자별 생산량과 비용을 조정해가며, 그에 따른 생산 부족분과 총수익을 확인할 수 있다.

## 첫 번째 테스트

다음은 생산 부족분의 결과값이 제대로 나오는지 확인하는 테스트 코드이다.  
먼저 픽스처(테스트에 필요한 데이터와 객체) 설정을 하고 이 픽스처의 속성들을 검증한다.

```javascript
import Province from '../Province.js'
import { sampleProvinceData } from '../util/data.js'

describe('Province 테스트', () => {
  it('shortfall', () => {
    const korea = new Province(sampleProvinceData()) // 픽스처 설정
    expect(korea.shortfall).toBe(5) // 검증
  })
})
```

테스트를 작성하여 모두 통과 했다는 것은 좋은 일 이지만, 많이 테스트를 하여도 실패하는 케이스가 없다면 그것 나름 불안감을 불러온다. 그래서 각각 케이스 마다 실패하는 모습을 한번씩 직접 확인해 보는 것이 좋다.

`자주 테스트하고, 작성 중인 코드는 최소한 몇 분 간격으로 테스트하자. 적어도 하루에 한 번은 전체 테스트를 돌려보자! (테스트 중 하나라도 실패한다면 리팩터링하면 안 된다. 먼저 테스트가 성공하도록 하자.)`
